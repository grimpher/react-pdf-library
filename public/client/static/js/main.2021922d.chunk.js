(window.webpackJsonpfront=window.webpackJsonpfront||[]).push([[0],{212:function(e,t,a){e.exports=a(424)},238:function(e,t,a){},422:function(e,t,a){},424:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(8),c=a.n(s),i=a(21),l=a(27),o=a(24),u=a(23),p=a(44),f=a(19),m=a(22),d=a(10),g=a(29),h=a.n(g),E=a(55),b=a(34),y=a.n(b);y.a.defaults.baseURL="/api";var v=function(e){return{type:"FETCH_FILES_SUCCESS",payload:{files:e}}},F=function(){return function(){var e=Object(E.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"FETCH_FILES_BEGIN"}),y.a.get("/files").then((function(e){var a=e.data;t(v(a)),Promise.resolve()})).catch((function(e){t({type:"FETCH_FILES_FAIL",payload:{error:e}}),Promise.reject(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},I=function(e){return{type:"DELETE_FILE_BEGIN",payload:{fileId:e}}},O=function(e){return{type:"DELETE_FILE_SUCCESS",payload:{fileId:e}}},S=function(e){return{type:"DELETE_FILE_FAIL",payload:{fileId:e}}},w=function(e,t){return function(){var a=Object(E.a)(h.a.mark((function a(n){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n({type:"UPDATE_FILE_BEGIN"}),y.a.patch("/files/"+e,Object(d.a)({},t)).then((function(e){n({type:"UPDATE_FILE_SUCCESS",payload:{updatedFile:e.data.updatedFile}}),Promise.resolve()})).catch((function(e){n({type:"UPDATE_FILE_FAIL"}),Promise.reject(e)}));case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},j=function(e){var t=e.token;return y.a.defaults.headers.common.Authorization="Bearer "+t,{type:"LOGIN_SUCCESS",payload:{token:t}}},C=a(430),_=a(433),P=a(426),L=a(77),D=a(47),k=a(207),U=a(11),T=a(427),R=(a(238),a(50)),N=a(425),A=a(76),x=a(432),G=a(429),M=a(434),V=C.a.Paragraph,H=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={isUploadingChanges:!1,inputValues:{niceName:e.props.fileInfo.niceName},valuesHasChanged:!1},e.toggleUploadingState=function(){e.setState((function(e){return{isUploadingChanges:!e.isUploadingChanges}}))},e.onInputChange=function(t){var a=t.target||{},n=a.name,r=a.value;e.setState((function(e){return{inputValues:Object(d.a)(Object(d.a)({},e.inputValues),{},Object(R.a)({},n,r))}})),e.state.valuesHasChanged||e.setState({valuesHasChanged:!0})},e.deleteFile=function(){e.props.deleteFile(e.props.fileInfo.niceId).then((function(){_.a.open({content:"File removing succeed",icon:r.a.createElement(U.a,{style:{color:"red"},type:"delete"})})})).catch((function(e){_.a.error("File removing failed",2),console.log(e)}))},e.updateFile=function(t){t&&t.preventDefault();var a={niceName:e.state.inputValues.niceName};e.toggleUploadingState(),e.props.updateFile(e.props.fileInfo.niceId,a).then((function(){e.props.fetchFiles(),e.toggleUploadingState(),_.a.open({content:"File update succeed",icon:r.a.createElement(U.a,{style:{color:"green"},type:"save"})}),e.props.toggleDetailsDrawer()})).catch((function(e){_.a.error("File updating failed",2),console.log(e)})),e.state.valuesHasChanged&&e.setState({valuesHasChanged:!1})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a={title:"Edit file",width:"25vw",placement:"left",closable:!0,onClose:e.toggleDetailsDrawer,visible:t},n=r.a.createElement(U.a,{type:"stop",style:{color:"red",fontSize:16}}),s=r.a.createElement(U.a,{className:"FileDetailsDrawer-delete-icon",type:"delete",style:{fontSize:24}}),c=r.a.createElement(N.a,{placement:"right",title:"Are you sure?",onConfirm:this.deleteFile,okType:"danger",okText:"Delete",cancelText:"No",icon:n},s),i=r.a.createElement(A.a,{loading:this.state.isUploadingChanges,onClick:this.updateFile,type:"primary",disabled:!this.state.valuesHasChanged},"Save",r.a.createElement(U.a,{type:"save"}));return r.a.createElement(x.a,a,r.a.createElement(G.a,{onSubmit:this.updateFile},r.a.createElement(V,null,"Display name:"),r.a.createElement(M.a,{name:"niceName",size:"large",value:this.state.inputValues.niceName,onChange:this.onInputChange}),r.a.createElement(L.a,{className:"FileDetailsDrawer-buttons-container",type:"flex",justify:"space-between"},c,i)))}}]),a}(n.Component),B=Object(m.b)(null,(function(e){return{fetchFiles:function(){return e(F())},deleteFile:function(t){return e(function(e){return function(){var t=Object(E.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a(I(e)),y.a.delete("/files/"+e).then((function(){a(O(e)),Promise.resolve()})).catch((function(t){a(S(e)),Promise.reject(t)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))},updateFile:function(t,a){return e(w(t,a))}}}))(H),z=C.a.Title,W=C.a.Paragraph,J=C.a.Text,Y=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={showDetailsDrawer:!1,niceNameInputValue:e.props.fileInfo.niceName,fileInfo:e.props.fileInfo,isUploadingChanges:!1},e.toggleDetailsDrawer=function(t){t&&t.preventDefault(),e.setState((function(e){return{showDetailsDrawer:!e.showDetailsDrawer}}))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.fileInfo,t=e.niceName,a=e.pagesRead,n=this.props.fileInfo.totalPages,s=Math.floor(a/n*100),c=n-a,i=Math.round(c/7),l=r.a.createElement(L.a,{type:"flex",align:"middle",justify:"space-between"},r.a.createElement(D.a,null,r.a.createElement(L.a,{type:"flex"},r.a.createElement(D.a,null,r.a.createElement(k.a,{type:"circle",percent:s,width:100,style:{marginRight:24}})),r.a.createElement(D.a,null,r.a.createElement(z,{style:{color:"#3498db"},level:4},t),r.a.createElement(W,null,n+" pages"),c>0&&r.a.createElement(W,null,"Read ",r.a.createElement(J,{strong:!0},i)," pages a day to finish this book in one week")))),r.a.createElement(D.a,null,r.a.createElement(U.a,{className:"FileCard-more-icon",onClick:this.toggleDetailsDrawer,type:"more",style:{fontSize:32}})));return r.a.createElement("div",null,r.a.createElement(D.a,{className:"FileCard"},r.a.createElement(p.b,{to:this.props.linkAddress},r.a.createElement(T.a,{hoverable:!0},l))),r.a.createElement(B,{fileInfo:e,visible:this.state.showDetailsDrawer,toggleDetailsDrawer:this.toggleDetailsDrawer}))}}]),a}(n.Component),q=C.a.Title,$=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).componentDidMount=function(){e.props.fetchFiles().catch((function(e){_.a.error("Files fetch failed"),console.log(e)}))},e}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,this.props.user.token?null:r.a.createElement(f.a,{to:"/login"}),r.a.createElement(q,{style:{color:"#3498db",margin:"1em 0 0 0",fontWeight:200},level:4},"Your books:"),r.a.createElement(P.a,{spinning:this.props.isFetching},r.a.createElement(L.a,{gutter:16},this.props.files.map((function(e){return r.a.createElement(Y,{key:e.niceId,linkAddress:"/file/"+e.niceId,fileInfo:e})})))))}}]),a}(n.Component),K=Object(m.b)((function(e){return{files:e.files.allFiles,isFetching:e.files.isFetching,user:e.user}}),(function(e){return{fetchFiles:function(){return e(F())}}}))($),Q=a(428).a.Dragger,X=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={isUploading:!1},e.uploadFile=function(t){var a=t.file;e.props.uploadFile(a).then((function(){_.a.success("File upload succeed",2)})).catch((function(e){_.a.error("File upload failed",2),console.log(e)}))},e.render=function(){return r.a.createElement(P.a,{spinning:e.state.isUploading},r.a.createElement(Q,{showUploadList:!1,name:"pdfFile",accept:".pdf",multiple:!1,customRequest:e.uploadFile},r.a.createElement("p",{className:"ant-upload-drag-icon"},r.a.createElement(U.a,{type:"file-add"}))))},e}return a}(n.Component),Z=Object(m.b)(null,(function(e){return{uploadFile:function(t){return e(function(e){return function(){var t=Object(E.a)(h.a.mark((function t(a){var n,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"UPLOAD_FILE_BEGIN"}),(n=new FormData).append("pdf",e),r={"Content-Type":"multipart/form-data"},y.a.post("/files/",n,{headers:r}).then((function(e){console.log(e),a({type:"UPLOAD_FILE_SUCCESS",payload:{newFile:e.data.newFile}}),Promise.resolve()})).catch((function(e){a({type:"UPLOAD_FILE_FAIL"}),Promise.reject(e)}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))}}}))(X),ee=a(431),te=C.a.Paragraph,ae=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={newPreferences:e.props.preferences,isPushing:!1},e.componentDidUpdate=function(t){t.preferences!==e.props.preferences&&e.setState({newPreferences:e.props.preferences})},e.onChangeSlider=function(t){return function(a){e.setState((function(e){return{newPreferences:Object(d.a)(Object(d.a)({},e.newPreferences),{},{dailyGoals:Object(d.a)(Object(d.a)({},e.newPreferences.dailyGoals),{},Object(R.a)({},t,a))})}}))}},e.pushChanges=function(t){t&&t.preventDefault(),e.state.newPreferences!==e.props.preferences&&(e.setState({isPushing:!0}),e.props.updateUserPreferences(e.state.newPreferences).then((function(){e.setState({isPushing:!1})})))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state.newPreferences.dailyGoals,t=e.pages,a=(e.minutes,this.state.isPushing);return r.a.createElement(r.a.Fragment,null,r.a.createElement(G.a,{onSubmit:this.pushChanges},r.a.createElement(L.a,null,r.a.createElement(te,null,"Pages to read a day"),r.a.createElement(ee.a,{value:t,onChange:this.onChangeSlider("pages"),max:500,step:5})),r.a.createElement(L.a,{type:"flex",justify:"end"},r.a.createElement(A.a,{htmlType:"submit",type:"primary",loading:a},"Save"))))}}]),a}(n.Component),ne=Object(m.b)((function(e){return{preferences:e.user.preferences}}),(function(e){return{updateUserPreferences:function(t){return e(function(e){return function(t){return new Promise((function(a,n){t({type:"UPDATE_USER_PREFERENCES_BEGIN"}),y.a.patch("/users/preferences",e).then((function(e){t(function(e){return{type:"UPDATE_USER_PREFERENCES_SUCCESS",payload:{newPreferences:e}}}(e.data.newPreferences)),a()})).catch((function(e){t({type:"UPDATE_USER_PREFERENCES_FAIL"}),console.log(e),n()}))}))}}(t))}}}))(ae),re=C.a.Title,se=C.a.Paragraph,ce=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={isLoading:!0,currentDate:""},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=new Date,a=t.getDate();a=a<10?"0"+a:a;var n=t.getMonth()+1;n=n<10?"0"+n:n;var r=t.getFullYear(),s="".concat(a,"-").concat(n,"-").concat(r);this.props.fetchUserInfo().then((function(){e.setState({isLoading:!1,currentDate:s})}))}},{key:"render",value:function(){var e=this.props.user,t=e.firstName,a=e.preferences,n=0,s=0;if(this.props.user.stats[this.state.currentDate]){var c=this.props.user.stats[this.state.currentDate];n=c.pages||0,s=c.minutes||0}var i=a.dailyGoals,l=this.state.isLoading,o={pages:Math.round(n/i.pages*100),minutes:Math.round(s/i.minutes*100)};return 0===i.pages&&(o.pages=100),0===i.minutes&&(o.minutes=100),r.a.createElement("div",null,r.a.createElement(P.a,{spinning:l},r.a.createElement(L.a,{type:"flex",justify:"space-between"},r.a.createElement(D.a,null,r.a.createElement(re,{level:3},"Hello, ",t)),r.a.createElement(D.a,null,r.a.createElement(A.a,{type:"link",onClick:this.props.logout},"Log out"))),r.a.createElement(L.a,null,r.a.createElement(re,{level:4,type:"secondary",style:{fontWeight:"200"}},"Your daily goals"),r.a.createElement(L.a,{type:"flex",justify:"space-around",style:{marginTop:"2em"}},r.a.createElement(D.a,null,r.a.createElement(k.a,{percent:o.pages,type:"circle"}),r.a.createElement(se,{style:{textAlign:"center",marginTop:"1em"}},n,i.pages>0&&"/"+i.pages," pages")))),r.a.createElement(ne,null)))}}]),a}(n.Component),ie=Object(m.b)((function(e){return{user:e.user}}),(function(e){return{logout:function(){return e((y.a.defaults.headers.common.Authorization="",localStorage.removeItem("token"),{type:"LOGOUT"}))},fetchUserInfo:function(){return e((function(e){return new Promise((function(t,a){e({type:"FETCH_USER_INFO_BEGIN"}),y.a.get("/users").then((function(a){var n,r=a.data.user,s=r.firstName,c=r.preferences,i=r.stats;e({type:"FETCH_USER_INFO_SUCCESS",payload:{firstName:(n={firstName:s,preferences:c,stats:i}).firstName,preferences:n.preferences,stats:n.stats}}),t()})).catch((function(t){console.log(t),e({type:"FETCH_USER_INFO_FAIL"}),a()}))}))}))}}}))(ce);var le=function(){return r.a.createElement(L.a,null,r.a.createElement(D.a,{span:20,offset:2},r.a.createElement(T.a,{style:{margin:"50px 0",borderRadius:"25px",boxShadow:"0 0 20px aliceblue"}},r.a.createElement(L.a,null,r.a.createElement(D.a,{span:16},r.a.createElement(Z,null),r.a.createElement(K,null)),r.a.createElement(D.a,{span:8,style:{paddingLeft:"2em"}},r.a.createElement(ie,null))))))},oe=a(100),ue=a(53),pe=(a(422),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={fileInfo:{},currentPage:null,lastUpdatedCurrentPage:null,lastPageChangeTime:(new Date).getTime(),minutesOfReading:0},n.componentDidMount=function(){var e=n.props.match.params.id;n.props.fetchFile(e),window.addEventListener("message",n.onMessage),setInterval((function(){var e=(new Date).getTime();n.state.lastPageChangeTime+6e5>e&&n.setState((function(e){return{minutesOfReading:e.minutesOfReading+1}}))}),6e4)},n.componentDidUpdate=function(e,t){if(n.updateReadPagesCount(),t.lastUpdatedCurrentPage!==n.state.lastUpdatedCurrentPage){var a=(new Date).getTime();n.setState({lastPageChangeTime:a})}},n.updateReadPagesCount=Object(E.a)(h.a.mark((function e(){var t,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.state.lastUpdatedCurrentPage!==n.state.currentPage,n.state.currentPage>n.props.file.pagesRead&&t&&(a={pagesRead:n.state.currentPage,minutesOfReading:n.state.minutesOfReading},n.props.updateFile(n.props.file.niceId,a).then((function(){n.setState({lastUpdatedCurrentPage:n.state.currentPage,minutesOfReading:0}),Promise.resolve()})).catch((function(e){Promise.reject(e)})));case 3:case"end":return e.stop()}}),e)}))),n.onMessage=function(e){if(!isNaN(parseInt(e.data))){var t=parseInt(e.data);n.setState({currentPage:t})}},n.render=function(){var e=n.props.file.path,t=n.props.file.pagesRead,a="/public/pdfJs/web/viewer.html?file=".concat(encodeURI(e),"#page=").concat(t," ");return r.a.createElement("div",{style:{height:"100vh",display:"flex",flexDirection:"column"}},r.a.createElement(p.b,{to:"/",onClick:n.updateReadPagesCount},r.a.createElement(ue.a,{placement:"right",title:"Back to homepage"},r.a.createElement("div",{className:"floating-back-button"},r.a.createElement(U.a,{type:"arrow-left"})))),r.a.createElement("iframe",{id:"pdfView",title:"pdfViewer",src:a,width:"100%",style:{border:0,height:"100%"}}))},n.onMessage=n.onMessage.bind(Object(oe.a)(n)),n}return a}(r.a.Component)),fe=Object(m.b)((function(e){return{file:e.files.singleFile}}),(function(e){return{fetchFile:function(t){return e(function(e){return function(){var t=Object(E.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"FETCH_SINGLE_FILE_BEGIN"}),y.a.get("/files/"+e).then((function(e){a({type:"FETCH_SINGLE_FILE_SUCCESS",payload:{fileInfo:e.data.file}}),Promise.resolve()})).catch((function(e){a({type:"FETCH_SINGLE_FILE_FAIL"}),Promise.reject(e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))},updateFile:function(t,a){return e(w(t,a))}}}))(pe),me=a(435),de=C.a.Title,ge=C.a.Text,he=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={emailValue:"",passwordValue:"",shouldRedirect:!1,feedbackMessage:null,loginInProgress:!1},e.submitLoginForm=function(t){t.preventDefault();var a=e.state,n=a.emailValue,r=a.passwordValue;return n&&r?n.includes("@")&&n.includes(".")?(e.setState({loginInProgress:!0}),void e.props.login(n,r).then((function(){setTimeout((function(){e.setState({shouldRedirect:!0})}),2e3)})).catch((function(t){e.setState({feedbackMessage:t,loginInProgress:!1})}))):e.setState({feedbackMessage:"Email incorrect"}):e.setState({feedbackMessage:"Fill in all form inputs"})},e.changeInput=function(t){var a=t.target,n=a.value,r=a.name;e.setState(Object(R.a)({},r+"Value",n))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=r.a.createElement("div",{style:{marginBottom:"2em"}},this.state.feedbackMessage&&r.a.createElement(me.a,{message:this.state.feedbackMessage,type:"error",showIcon:!0}));return r.a.createElement(L.a,null,this.state.shouldRedirect&&r.a.createElement(f.a,{to:"/"}),r.a.createElement(D.a,{span:8,offset:8},r.a.createElement(T.a,{style:{margin:"50px 0",borderRadius:"25px",boxShadow:"0 0 20px aliceblue"}},r.a.createElement(de,{level:2,style:{textAlign:"center"}},"Login"),r.a.createElement(L.a,null,r.a.createElement(D.a,{span:16,offset:4},e,r.a.createElement(G.a,{onSubmit:this.submitLoginForm},r.a.createElement(G.a.Item,null,r.a.createElement(M.a,{prefix:r.a.createElement(U.a,{type:"mail"}),placeholder:"Email",name:"email",onChange:this.changeInput,value:this.state.emailValue})),r.a.createElement(G.a.Item,null,r.a.createElement(M.a,{type:"password",prefix:r.a.createElement(U.a,{type:"lock"}),placeholder:"Password",name:"password",onChange:this.changeInput,value:this.state.passwordValue})),r.a.createElement(A.a,{type:"primary",htmlType:"submit",loading:this.state.loginInProgress},"Log in"),r.a.createElement(ge,{style:{margin:"0 1em"}},"or"),r.a.createElement(p.b,{to:"/register"},r.a.createElement(A.a,{type:"secondary"},"Register"))))))))}}]),a}(n.Component),Ee=Object(m.b)(null,(function(e){return{login:function(t,a){return e(function(e,t){return function(){var a=Object(E.a)(h.a.mark((function a(n){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise((function(a,r){n({type:"LOGIN_BEGIN"});y.a.post("/auth/login",{email:e,password:t},{validateStatus:function(e){return[200,400,500].includes(e)}}).then((function(e){if(200===e.status){var t=e.data.token;n(j({token:t})),a(e)}else r(e.data.message),n({type:"LOGIN_FAIL"})})).catch((function(e){console.log(e),r()}))})));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}(t,a))}}}))(he),be=C.a.Title,ye=C.a.Text,ve=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={emailValue:"",passwordValue:"",passwordRepeatValue:"",firstNameValue:"",shouldRedirect:!1,feedbackMessage:null,registerInProgress:!1},e.submitRegisterForm=function(t){t.preventDefault();var a=e.state,n=a.emailValue,r=a.passwordValue,s=a.firstNameValue,c=a.passwordRepeatValue;return n&&r&&s&&c?c!==r?e.setState({feedbackMessage:"Passwords are not the same"}):n.includes("@")&&n.includes(".")?(e.setState({registerInProgress:!0}),void e.props.register(n,r,s).then((function(){setTimeout((function(){e.setState({shouldRedirect:!0})}),2e3)})).catch((function(t){e.setState({feedbackMessage:t,registerInProgress:!1})}))):e.setState({feedbackMessage:"Email incorrect"}):e.setState({feedbackMessage:"Fill in all form inputs"})},e.changeInput=function(t){var a=t.target,n=a.value,r=a.name;e.setState(Object(R.a)({},r+"Value",n))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=r.a.createElement("div",{style:{marginBottom:"2em"}},this.state.feedbackMessage&&r.a.createElement(me.a,{message:this.state.feedbackMessage,type:"error",showIcon:!0}));return r.a.createElement(L.a,null,this.state.shouldRedirect&&r.a.createElement(f.a,{to:"/"}),r.a.createElement(D.a,{span:8,offset:8},r.a.createElement(T.a,{style:{margin:"50px 0",borderRadius:"25px",boxShadow:"0 0 20px aliceblue"}},r.a.createElement(be,{level:2,style:{textAlign:"center"}},"Register"),r.a.createElement(L.a,null,r.a.createElement(D.a,{span:16,offset:4},e,r.a.createElement(G.a,{onSubmit:this.submitRegisterForm},r.a.createElement(G.a.Item,null,r.a.createElement(M.a,{prefix:r.a.createElement(U.a,{type:"mail"}),placeholder:"Email",name:"email",onChange:this.changeInput})),r.a.createElement(G.a.Item,null,r.a.createElement(M.a,{prefix:r.a.createElement(U.a,{type:"user"}),placeholder:"First name",name:"firstName",onChange:this.changeInput})),r.a.createElement(G.a.Item,null,r.a.createElement(M.a,{type:"password",prefix:r.a.createElement(U.a,{type:"lock"}),placeholder:"Password",name:"password",onChange:this.changeInput})),r.a.createElement(G.a.Item,null,r.a.createElement(M.a,{type:"password",prefix:r.a.createElement(U.a,{type:"lock"}),placeholder:"Confirm password",name:"passwordRepeat",onChange:this.changeInput})),r.a.createElement(A.a,{type:"primary",htmlType:"submit",loading:this.state.registerInProgress},"Register"),r.a.createElement(ye,{style:{margin:"0 1em"}},"or"),r.a.createElement(p.b,{to:"/login"},r.a.createElement(A.a,{type:"secondary"},"Log in"))))))))}}]),a}(n.Component),Fe=Object(m.b)(null,(function(e){return{register:function(t,a,n){return e(function(e,t,a){return function(n){return new Promise((function(r,s){n({type:"REGISTER_BEGIN"});y.a.post("/auth/register",{email:e,password:t,firstName:a},{validateStatus:function(e){return[201,500,409,400].includes(e)}}).then((function(e){201===e.status?(n({type:"REGISTER_SUCCESS"}),n(j({token:e.data.token})),r()):(n({type:"REGISTER_FAIL"}),s(e.data.message?e.data.message:"Unknown error"))})).catch((function(e){console.log(e),s()}))}))}}(t,a,n))}}}))(ve),Ie=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).props.readCache(),n}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement(f.b,{path:"/",exact:!0,component:le}),r.a.createElement(f.b,{path:"/file/:id",exact:!0,component:fe}),r.a.createElement(f.b,{path:"/login",exact:!0,component:Ee}),r.a.createElement(f.b,{path:"/register",exact:!0,component:Fe}))}}]),a}(r.a.Component),Oe=Object(m.b)((function(e){return{user:e.user}}),(function(e){return{readCache:function(){return e(function(){var e=localStorage.getItem("token");return y.a.defaults.headers.common.Authorization="Bearer "+e,{type:"READ_CACHE",payload:{token:e}}}())}}}))(Ie);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(423);var Se=a(61),we=a(205),je=a(206),Ce={allFiles:[],singleFile:{},isFetching:!1},_e={token:"",firstName:"Unknown",stats:{},preferences:{dailyGoals:{pages:0,minutes:0}}},Pe=Object(Se.combineReducers)({files:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_FILES_BEGIN":return Object(d.a)(Object(d.a)({},e),{},{isFetching:!0});case"FETCH_FILES_SUCCESS":return Object(d.a)(Object(d.a)({},e),{},{allFiles:t.payload.files.reverse(),isFetching:!1});case"FETCH_FILES_FAIL":return Object(d.a)(Object(d.a)({},e),{},{isFetching:!1});case"DELETE_FILE_BEGIN":return Object(d.a)(Object(d.a)({},e),{},{isFetching:!0});case"DELETE_FILE_SUCCESS":return Object(d.a)(Object(d.a)({},e),{},{allFiles:e.allFiles.filter((function(e){return e.niceId!==t.payload.fileId})),isFetching:!1});case"DELETE_FILE_FAIL":return Object(d.a)(Object(d.a)({},e),{},{isFetching:!1});case"UPLOAD_FILE_BEGIN":return Object(d.a)(Object(d.a)({},e),{},{isFetching:!0});case"UPLOAD_FILE_SUCCESS":var a=e.allFiles;return a.unshift(t.payload.newFile),Object(d.a)(Object(d.a)({},e),{},{allFiles:a,isFetching:!1});case"UPLOAD_FILE_FAIL":return Object(d.a)(Object(d.a)({},e),{},{isFetching:!1});case"UPDATE_FILE_BEGIN":return Object(d.a)(Object(d.a)({},e),{},{isFetching:!0});case"UPDATE_FILE_SUCCESS":var n=t.payload.updatedFile,r=e.allFiles.map((function(e){return e.niceId===n.niceId?n:e}));return Object(d.a)(Object(d.a)({},e),{},{allFiles:r,isFetching:!1});case"UPDATE_FILE_FAIL":return Object(d.a)(Object(d.a)({},e),{},{isFetching:!1});case"FETCH_SINGLE_FILE_SUCCESS":return Object(d.a)(Object(d.a)({},e),{},{singleFile:t.payload.fileInfo});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"READ_CACHE":var a=t.payload.token;return localStorage.setItem("token",a),Object(d.a)(Object(d.a)({},e),{},{token:a});case"LOGIN_SUCCESS":var n=t.payload.token;return localStorage.setItem("token",n),Object(d.a)(Object(d.a)({},e),{},{token:n});case"LOGOUT":return localStorage.removeItem("token"),_e;case"FETCH_USER_INFO_SUCCESS":var r=t.payload,s=r.firstName,c=r.preferences,i=r.stats;return Object(d.a)(Object(d.a)({},e),{},{firstName:s,preferences:c,stats:i});case"UPDATE_USER_PREFERENCES_SUCCESS":var l=t.payload.newPreferences.dailyGoals;return Object(d.a)(Object(d.a)({},e),{},{preferences:{dailyGoals:{pages:l.pages,minutes:l.minutes}}});default:return e}}}),Le=Object(Se.createStore)(Pe,Object(je.composeWithDevTools)(Object(Se.applyMiddleware)(we.a))),De=r.a.createElement(m.a,{store:Le},r.a.createElement(Oe,null));c.a.render(De,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[212,1,2]]]);
//# sourceMappingURL=main.2021922d.chunk.js.map